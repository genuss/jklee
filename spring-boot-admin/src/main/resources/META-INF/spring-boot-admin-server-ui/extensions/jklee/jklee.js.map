{"version":3,"file":"jklee.js","sources":["../../../../../vue/jklee.vue","../../../../../vue/index.js"],"sourcesContent":["<!--\n  - Show raw settings string for current instance\n  - Show settings pretty-printed\n  - Show list of currently available VM log files as links to download them\n  - Form to update settings (in separate view most certainly)\n  -\n\n-->\n<template>\n  <sba-instance-section :error=\"error\" :loading=\"!hasLoaded\">\n    <sba-panel :title=\"'Settings'\">\n      <template v-for=\"(setting, index) in settings\" :key=\"settings.name\">\n        <div>\n          <div class=\"flex items-center px-4 py-3\" :class=\"{\n            'bg-gray-50': index % 2 === 0,\n          }\">\n            <div class=\"flex-1 sm:break-all\">\n              <span v-text=\"setting.name\"/>\n            </div>\n            <div>\n              <span v-text=\"setting.value\"/>\n            </div>\n          </div>\n        </div>\n      </template>\n    </sba-panel>\n\n\n    <sba-panel :title=\"'Profiling results'\">\n      <div class=\"content info\">\n        <table class=\"table\">\n          <tr\n            v-for=\"result in results\"\n            :key=\"result.name\"\n          >\n            <td class=\"info__key\">\n              <a\n                class=\"btn btn-primary\"\n                :href=\"`instances/${instance.id}/actuator/jkleeFiles/${result.name}`\"\n              >\n                <i class=\"fa fa-download\"></i>&nbsp;\n                <span v-text=\"result.name\"/>\n              </a>\n            </td>\n            <td class=\"info__key\" v-text=\"result.endedAt\"/>\n          </tr>\n        </table>\n      </div>\n    </sba-panel>\n\n    <div>\n      sessionName:\n      <input\n        type=\"text\"\n        v-model=\"profileSessionName\"\n      >\n      <br>\n      rawArguments:\n      <input\n        type=\"text\"\n        v-model=\"profileRawArguments\"\n      >\n      <br>\n      profileFormat:\n      <input\n        type=\"text\"\n        v-model=\"profileFormat\"\n      >\n      <br>\n      profileDuration:\n      <input\n        type=\"text\"\n        v-model=\"profileDuration\"\n      >\n      <br>\n\n      <sba-button\n        :disabled=\"profiling\"\n        @click=\"profile(profileSessionName, profileRawArguments, profileDuration, profileFormat)\"\n      >\n        <template v-if=\"!profiling\">\n          <font-awesome-icon icon=\"download\"/>&nbsp;\n          <span>Start profiling</span>\n        </template>\n        <template v-else>\n          <div class=\"loader\">Profiling...</div>\n        </template>\n      </sba-button>\n    </div>\n  </sba-instance-section>\n\n</template>\n\n<script>\nexport default {\n  props: {\n    instance: {\n      type: Object,\n      required: true\n    }\n  },\n  data: () => ({\n    error: null,\n    hasLoaded: false,\n    settings: [],\n    results: [],\n    profileRawArguments: 'start,event=itimer,interval=1ms',\n    profileSessionName: 'test',\n    profileDuration: '2s',\n    profileFormat: 'FLAMEGRAPH',\n    profiling: false,\n  }),\n  methods: {\n    async profile(sessionName, rawArguments, profileDuration, profileFormat) {\n      this.profiling = true;\n      const durationInMillis = parseToMillis(profileDuration);\n      setTimeout(() => {\n        this.profiling = false;\n        this.updateResultsList()\n      }, durationInMillis)\n\n      await this.instance.axios.post(\n        `actuator/jkleeProfile/${sessionName}`,\n        {\n          rawArguments: rawArguments,\n          duration: profileDuration,\n          format: profileFormat,\n        }\n      )\n      .then((response) => {\n        console.log(response)\n      })\n    },\n    async updateResultsList() {\n      const response = await this.instance.axios.get('actuator/jkleeFiles');\n      this.results = response.data.results;\n    }\n  },\n  async created() {\n    try {\n      const response = await this.instance.axios.get('actuator/jkleeSettings');\n      this.settings = response.data.settings;\n    } catch (error) {\n      this.error = error\n    } finally {\n      this.hasLoaded = true;\n    }\n    await this.updateResultsList()\n  }\n};\n\nfunction parseToMillis(timeString) {\n  let value = parseInt(timeString, 10);\n  let unit = timeString.slice(-1);\n  let millis = 0;\n\n  if (unit === 's') {\n    millis = value * 1000;\n  } else if (unit === 'm') {\n    millis = value * 60 * 1000;\n  } else if (unit === 'h') {\n    millis = value * 60 * 60 * 1000;\n  } else if (unit === 'd') {\n    millis = value * 60 * 60 * 24 * 1000;\n  }\n\n  return millis;\n}\n</script>\n","import jkleeEndpoint from './jklee.vue';\n\nSBA.viewRegistry.addView({\n  group: \"jklee\",\n  name: \"instances/jklee\",\n  parent: \"instances\",\n  path: \"jklee\",\n  component: jkleeEndpoint,\n  label: \"jklee\",\n  isEnabled: ({ instance }) => {\n    return instance.hasEndpoint(\"jkleeSettings\");\n  },\n})\n\n// Icon taken from https://www.svgrepo.com/svg/258533/clover under CC0 license\nSBA.viewRegistry.setGroupIcon(\n    \"jklee\",\n    `<svg xmlns=\"http://www.w3.org/2000/svg\"\n          class='h-5 w-5 mr-3'\n          viewBox=\"0 0 512 512\"\n          xml:space=\"preserve\">\n<g>\n    <g>\n        <path d=\"M477.109,245.333c15.189-14.432,24.224-33.899,24.224-53.333c0-42.731-51.413-74.667-97.387-74.667\n            c-4.181,0-13.077,0-31.371,10.347c6.912-12.597,10.357-23.147,10.357-31.68c0-45.408-30.432-96-74.08-96\n            C288.93,0.005,269.86,8.087,256,22.4C242.143,8.09,223.077,0.008,203.157,0c-43.648,0-74.091,50.581-74.091,96\n            c0,8.533,3.413,19.093,10.336,31.68c-18.283-10.347-27.179-10.347-31.349-10.347c-45.973,0-97.387,31.925-97.387,74.667\n            c0,19.435,9.045,38.901,24.235,53.333c-15.189,14.443-24.235,33.909-24.235,53.333c0,42.741,51.413,74.667,97.387,74.667\n            c34.667,0,105.675-33.387,137.28-49.163v109.483c0,44.672,18.997,78.347,44.192,78.347H320c5.891,0,10.667-4.776,10.667-10.667\n            s-4.776-10.667-10.667-10.667h-30.475c-9.099,0-22.859-22.741-22.859-57.013V324.171c31.605,15.776,102.613,49.163,137.28,49.163\n            c45.973,0,97.387-31.936,97.387-74.667C501.333,279.243,492.288,259.776,477.109,245.333z M403.947,352\n            c-32.48,0-114.208-39.467-142.933-54.677c-3.123-1.654-6.861-1.654-9.984,0C222.261,312.533,140.533,352,108.053,352\n            C68.96,352,32,326.069,32,298.667c0-20,13.355-36.085,25.856-44.48c4.893-3.281,6.199-9.908,2.917-14.8\n            c-0.773-1.153-1.764-2.144-2.917-2.917C45.355,228.096,32,212.011,32,192c0-27.403,36.96-53.333,76.053-53.333\n            c6.699,0,28.16,5.44,82.581,55.819c4.343,3.98,11.091,3.685,15.071-0.658c3.707-4.046,3.74-10.244,0.076-14.329\n            C155.819,124.469,150.4,102.773,150.4,96c0-38.4,25.6-74.667,52.725-74.667c17.728,0.019,34.249,8.986,43.925,23.84\n            c3.237,4.922,9.851,6.288,14.773,3.051c1.214-0.799,2.252-1.837,3.051-3.051c9.69-14.857,26.22-23.822,43.957-23.84\n            C336,21.333,361.6,57.6,361.6,96c0,6.773-5.397,28.459-55.349,83.509c-3.969,4.353-3.658,11.1,0.695,15.069\n            c4.102,3.74,10.387,3.709,14.452-0.072c54.4-50.4,75.883-55.829,82.571-55.829c39.093,0,76.053,25.92,76.053,53.333\n            c0,20.032-13.344,36.107-25.845,44.469c-4.895,3.277-6.207,9.902-2.93,14.798c0.776,1.159,1.771,2.155,2.93,2.93\n            C466.645,262.56,480,278.645,480,298.667C480,326.08,443.04,352,403.947,352z\"/>\n    </g>\n</g>\n</svg>`\n);\n"],"names":["_createElementVNode","_createBlock","_createVNode","_openBlock","_createElementBlock","_Fragment","_renderList","_toDisplayString"],"mappings":"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"}