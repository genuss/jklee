{"version":3,"file":"jklee.js","sources":["../../../../../vue/jklee.vue","../../../../../vue/index.js"],"sourcesContent":["<template>\n  <sba-instance-section :error=\"error\" :loading=\"!hasLoaded\">\n    <sba-panel :title=\"$t('jklee.ui.results')\">\n      <div class=\"grid grid-cols-2 gap-4\">\n        <template v-for=\"result in results\">\n          <div class=\"border p-2 flex\">\n            <div class=\"w-1/2 pr-2\">\n              <a :href=\"`instances/${instance.id}/actuator/jkleeFiles/${result.name}`\">\n                <font-awesome-icon icon=\"download\" class=\"mr-2\"/>\n                <span v-text=\"result.name\"/>\n              </a>\n            </div>\n            <div class=\"w-1/2\" v-text=\"result.endedAt\"/>\n          </div>\n        </template>\n      </div>\n\n    </sba-panel>\n\n    <sba-panel :title=\"$t('jklee.ui.session.title')\">\n      <div class=\"flex gap-6 flex-col lg:flex-row\">\n        <div class=\"flex-1\">\n          <sba-input\n            v-model=\"profileRequest.sessionName\"\n            :label=\"$t('jklee.ui.session.name')\"\n            :placeholder=\"$t('jklee.ui.session.name')\"\n          />\n        </div>\n        <div class=\"flex-1\">\n          <sba-select\n            :name=\"$t('jklee.ui.session.format')\"\n            :label=\"$t('jklee.ui.session.format')\"\n            :options=\"profileProperties.formats\"\n            v-model=\"profileRequest.format\"\n            class=\"focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md\"\n          >\n          </sba-select>\n        </div>\n        <div class=\"flex-1\">\n          <sba-input\n            :label=\"$t('jklee.ui.session.duration')\"\n            v-model=\"profileRequest.duration\"\n            :placeholder=\"$t('jklee.ui.session.duration')\"\n          />\n        </div>\n      </div>\n      <div class=\"flex\">\n        <div class=\"flex-1 mr-4\">\n          <sba-input\n            v-model=\"profileRequest.rawArguments\"\n            :label=\"$t('jklee.ui.session.arguments')\"\n            :placeholder=\"$t('jklee.ui.session.arguments')\"/>\n        </div>\n        <sba-button\n          :disabled=\"profiling\"\n          @click=\"profile(profileRequest)\"\n        >\n          <template v-if=\"!profiling\">\n            <font-awesome-icon icon=\"download\"/>\n            <span v-text=\"$t('jklee.ui.session.start')\"/>\n          </template>\n          <template v-else>\n            <span v-text=\"$t('jklee.ui.session.profiling')\"/>\n          </template>\n        </sba-button>\n      </div>\n\n    </sba-panel>\n\n    <sba-panel :title=\"$t('jklee.ui.settings')\">\n      <template v-for=\"(setting, index) in settings.data\" :key=\"setting.name\">\n        <div>\n          <div class=\"flex items-center px-4 py-3\" :class=\"{\n            'bg-gray-50': index % 2 === 0,\n          }\">\n            <div class=\"flex-1 sm:break-all\">\n              <span v-text=\"setting.name\"/>\n            </div>\n            <div>\n              <span v-text=\"setting.value\"/>\n            </div>\n          </div>\n        </div>\n      </template>\n    </sba-panel>\n  </sba-instance-section>\n\n</template>\n\n<script>\nexport default {\n  props: {\n    instance: {\n      type: Object,\n      required: true\n    }\n  },\n  data: () => ({\n    error: null,\n    hasLoaded: false,\n    settings: {\n      data: [],\n    },\n    profileProperties: {},\n    profileRequest: {\n      sessionName: 'test',\n      rawArguments: 'start,event=itimer,interval=1ms',\n      duration: '2s',\n      format: 'FLAMEGRAPH',\n    },\n    results: [],\n    profiling: false,\n  }),\n  methods: {\n    async profile(profileRequest) {\n      this.profiling = true;\n      const durationInMillis = parseToMillis(profileRequest.duration);\n      setTimeout(() => {\n        this.profiling = false;\n        this.updateResultsList()\n      }, durationInMillis)\n\n      await this.instance.axios.post(\n        `actuator/jkleeProfile/${profileRequest.sessionName}`,\n        {\n          rawArguments: profileRequest.rawArguments,\n          duration: profileRequest.duration,\n          format: profileRequest.format,\n        }\n      )\n      .then((response) => {\n        console.log(response)\n      })\n    },\n    async updateResultsList() {\n      const response = await this.instance.axios.get('actuator/jkleeFiles');\n      this.results = response.data.results;\n    }\n  },\n  async created() {\n    try {\n      const settingsResponse = await this.instance.axios.get('actuator/jkleeSettings');\n      this.settings.data = settingsResponse.data.settings;\n\n      const profileResponse = await this.instance.axios.get('actuator/jkleeProfile');\n      this.profileProperties = profileResponse.data;\n\n    } catch (error) {\n      this.error = error\n    } finally {\n      this.hasLoaded = true;\n    }\n    await this.updateResultsList()\n  }\n};\n\nfunction parseToMillis(timeString) {\n  let value = parseInt(timeString, 10);\n  let unit = timeString.slice(-1);\n  let millis = 0;\n\n  if (unit === 's') {\n    millis = value * 1000;\n  } else if (unit === 'm') {\n    millis = value * 60 * 1000;\n  } else if (unit === 'h') {\n    millis = value * 60 * 60 * 1000;\n  } else if (unit === 'd') {\n    millis = value * 60 * 60 * 24 * 1000;\n  }\n\n  return millis;\n}\n</script>\n","import jkleeEndpoint from './jklee.vue';\nimport en from './i18n.en.json';\nimport de from './i18n.de.json';\n\nSBA.use({\n  install({ viewRegistry, i18n }) {\n    viewRegistry.addView({\n      group: \"jklee\",\n      name: \"instances/jklee\",\n      parent: \"instances\",\n      path: \"jklee\",\n      component: jkleeEndpoint,\n      label: \"jklee\",\n      isEnabled: ({ instance }) => {\n        return instance.hasEndpoint(\"jkleeSettings\");\n      },\n    });\n    i18n.mergeLocaleMessage(\"en\", en);\n    i18n.mergeLocaleMessage(\"de\", de);\n  },\n});\n\n// Icon taken from https://www.svgrepo.com/svg/258533/clover under CC0 license\nSBA.viewRegistry.setGroupIcon(\n    \"jklee\",\n    `<svg xmlns=\"http://www.w3.org/2000/svg\"\n          class='h-5 w-5 mr-3'\n          viewBox=\"0 0 512 512\"\n          xml:space=\"preserve\">\n<g>\n    <g>\n        <path d=\"M477.109,245.333c15.189-14.432,24.224-33.899,24.224-53.333c0-42.731-51.413-74.667-97.387-74.667\n            c-4.181,0-13.077,0-31.371,10.347c6.912-12.597,10.357-23.147,10.357-31.68c0-45.408-30.432-96-74.08-96\n            C288.93,0.005,269.86,8.087,256,22.4C242.143,8.09,223.077,0.008,203.157,0c-43.648,0-74.091,50.581-74.091,96\n            c0,8.533,3.413,19.093,10.336,31.68c-18.283-10.347-27.179-10.347-31.349-10.347c-45.973,0-97.387,31.925-97.387,74.667\n            c0,19.435,9.045,38.901,24.235,53.333c-15.189,14.443-24.235,33.909-24.235,53.333c0,42.741,51.413,74.667,97.387,74.667\n            c34.667,0,105.675-33.387,137.28-49.163v109.483c0,44.672,18.997,78.347,44.192,78.347H320c5.891,0,10.667-4.776,10.667-10.667\n            s-4.776-10.667-10.667-10.667h-30.475c-9.099,0-22.859-22.741-22.859-57.013V324.171c31.605,15.776,102.613,49.163,137.28,49.163\n            c45.973,0,97.387-31.936,97.387-74.667C501.333,279.243,492.288,259.776,477.109,245.333z M403.947,352\n            c-32.48,0-114.208-39.467-142.933-54.677c-3.123-1.654-6.861-1.654-9.984,0C222.261,312.533,140.533,352,108.053,352\n            C68.96,352,32,326.069,32,298.667c0-20,13.355-36.085,25.856-44.48c4.893-3.281,6.199-9.908,2.917-14.8\n            c-0.773-1.153-1.764-2.144-2.917-2.917C45.355,228.096,32,212.011,32,192c0-27.403,36.96-53.333,76.053-53.333\n            c6.699,0,28.16,5.44,82.581,55.819c4.343,3.98,11.091,3.685,15.071-0.658c3.707-4.046,3.74-10.244,0.076-14.329\n            C155.819,124.469,150.4,102.773,150.4,96c0-38.4,25.6-74.667,52.725-74.667c17.728,0.019,34.249,8.986,43.925,23.84\n            c3.237,4.922,9.851,6.288,14.773,3.051c1.214-0.799,2.252-1.837,3.051-3.051c9.69-14.857,26.22-23.822,43.957-23.84\n            C336,21.333,361.6,57.6,361.6,96c0,6.773-5.397,28.459-55.349,83.509c-3.969,4.353-3.658,11.1,0.695,15.069\n            c4.102,3.74,10.387,3.709,14.452-0.072c54.4-50.4,75.883-55.829,82.571-55.829c39.093,0,76.053,25.92,76.053,53.333\n            c0,20.032-13.344,36.107-25.845,44.469c-4.895,3.277-6.207,9.902-2.93,14.798c0.776,1.159,1.771,2.155,2.93,2.93\n            C466.645,262.56,480,278.645,480,298.667C480,326.08,443.04,352,403.947,352z\"/>\n    </g>\n</g>\n</svg>`\n);\n"],"names":["_createBlock","_createVNode","_createElementVNode","_createElementBlock","_Fragment","_renderList","_openBlock","_toDisplayString"],"mappings":"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"}