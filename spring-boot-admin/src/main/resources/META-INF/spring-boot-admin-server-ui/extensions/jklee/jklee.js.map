{"version":3,"file":"jklee.js","sources":["../../../../../vue/jklee.vue","../../../../../vue/index.js"],"sourcesContent":["<!--\n  - Show raw settings string for current instance\n  - Show settings pretty-printed\n  - Show list of currently available VM log files as links to download them\n  - Form to update settings (in separate view most certainly)\n  -\n\n-->\n<template>\n  <sba-instance-section :error=\"error\" :loading=\"!hasLoaded\">\n    <sba-panel :title=\"'Settings'\">\n      <template v-for=\"(setting, index) in settings\" :key=\"settings.name\">\n        <div>\n          <div class=\"flex items-center px-4 py-3\" :class=\"{\n            'bg-gray-50': index % 2 === 0,\n          }\">\n            <div class=\"flex-1 sm:break-all\">\n              <span v-text=\"setting.name\"/>\n            </div>\n            <div>\n              <span v-text=\"setting.value\"/>\n            </div>\n          </div>\n        </div>\n      </template>\n    </sba-panel>\n\n\n    <sba-panel :title=\"'Profiling results'\">\n      <div class=\"content info\">\n        <table class=\"table\">\n          <tr\n            v-for=\"result in results\"\n            :key=\"result.name\"\n          >\n            <td class=\"info__key\">\n              <a\n                class=\"btn btn-primary\"\n                :href=\"`instances/${instance.id}/actuator/jklee-files/${result.name}`\"\n              >\n                <i class=\"fa fa-download\"></i>&nbsp;\n                <span v-text=\"result.name\"/>\n              </a>\n            </td>\n            <td class=\"info__key\" v-text=\"result.endedAt\"/>\n          </tr>\n        </table>\n      </div>\n    </sba-panel>\n\n    <div>\n      sessionName:\n      <input\n        type=\"text\"\n        v-model=\"profileSessionName\"\n      >\n      <br>\n      rawArguments:\n      <input\n        type=\"text\"\n        v-model=\"profileRawArguments\"\n      >\n      <br>\n      profileFormat:\n      <input\n        type=\"text\"\n        v-model=\"profileFormat\"\n      >\n      <br>\n      profileDuration:\n      <input\n        type=\"text\"\n        v-model=\"profileDuration\"\n      >\n      <br>\n\n      <sba-button\n        :disabled=\"profiling\"\n        @click=\"profile(profileSessionName, profileRawArguments, profileDuration, profileFormat)\"\n      >\n        <template v-if=\"!profiling\">\n          <font-awesome-icon icon=\"download\"/>&nbsp;\n          <span>Start profiling</span>\n        </template>\n        <template v-else>\n          <div class=\"loader\">Profiling...</div>\n        </template>\n      </sba-button>\n    </div>\n  </sba-instance-section>\n\n</template>\n\n<script>\nexport default {\n  props: {\n    instance: {\n      type: Object,\n      required: true\n    }\n  },\n  data: () => ({\n    error: null,\n    hasLoaded: false,\n    settings: [],\n    results: [],\n    profileRawArguments: 'start,event=itimer,interval=1ms',\n    profileSessionName: 'test',\n    profileDuration: '2s',\n    profileFormat: 'FLAMEGRAPH',\n    profiling: false,\n  }),\n  methods: {\n    async profile(sessionName, rawArguments, profileDuration, profileFormat) {\n      this.profiling = true;\n      const durationInMillis = parseToMillis(profileDuration);\n      setTimeout(() => {\n        this.profiling = false;\n        this.updateResultsList()\n      }, durationInMillis)\n\n      await this.instance.axios.post(\n        `actuator/jklee-profile/${sessionName}`,\n        {\n          rawArguments: rawArguments,\n          duration: profileDuration,\n          format: profileFormat,\n        }\n      )\n      .then((response) => {\n        console.log(response)\n      })\n    },\n    async updateResultsList() {\n      const response = await this.instance.axios.get('actuator/jklee-files');\n      this.results = response.data.results;\n    }\n  },\n  async created() {\n    try {\n      const response = await this.instance.axios.get('actuator/jklee-settings');\n      this.settings = response.data.settings;\n    } catch (error) {\n      this.error = error\n    } finally {\n      this.hasLoaded = true;\n    }\n    await this.updateResultsList()\n  }\n};\n\nfunction parseToMillis(timeString) {\n  let value = parseInt(timeString, 10);\n  let unit = timeString.slice(-1);\n  let millis = 0;\n\n  if (unit === 's') {\n    millis = value * 1000;\n  } else if (unit === 'm') {\n    millis = value * 60 * 1000;\n  } else if (unit === 'h') {\n    millis = value * 60 * 60 * 1000;\n  } else if (unit === 'd') {\n    millis = value * 60 * 60 * 24 * 1000;\n  }\n\n  return millis;\n}\n</script>\n","import jkleeEndpoint from './jklee.vue';\n\nSBA.viewRegistry.addView({\n  name: \"instances/jklee\",\n  parent: \"instances\",\n  path: \"jklee\",\n  component: jkleeEndpoint,\n  label: \"jklee\",\n  isEnabled: ({ instance }) => {\n    return instance.hasEndpoint(\"jklee-settings\");\n  },\n})\n"],"names":["_createElementVNode","_createBlock","_createVNode","_openBlock","_createElementBlock","_Fragment","_renderList","_toDisplayString"],"mappings":"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"}