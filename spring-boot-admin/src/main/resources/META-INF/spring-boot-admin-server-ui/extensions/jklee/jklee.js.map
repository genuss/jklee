{"version":3,"file":"jklee.js","sources":["../../../../../vue/jklee.vue","../../../../../vue/index.js"],"sourcesContent":["<!--\n  - Show raw settings string for current instance\n  - Show settings pretty-printed\n  - Show list of currently available VM log files as links to download them\n  - Form to update settings (in separate view most certainly)\n  -\n\n-->\n<template>\n  <div class=\"jklee\">\n    <pre>Raw settings:<br><span v-text=\"settings\"/></pre>\n\n    <sba-panel :title=\"'Profiling results'\">\n      <div class=\"content info\">\n        <table class=\"table\">\n          <tr\n            v-for=\"result in results\"\n            :key=\"result.name\"\n          >\n            <td class=\"info__key\">\n              <a\n                class=\"btn btn-primary\"\n                :href=\"`instances/${instance.id}/actuator/jklee-files/${result.name}`\"\n              >\n                <i class=\"fa fa-download\"></i>&nbsp;\n                <span v-text=\"result.name\"/>\n              </a>\n            </td>\n            <td class=\"info__key\" v-text=\"result.endedAt\"/>\n          </tr>\n        </table>\n      </div>\n    </sba-panel>\n\n    <div>\n      sessionName:\n      <input\n        type=\"text\"\n        v-model=\"profileSessionName\"\n      >\n      <br>\n      rawArguments:\n      <input\n        type=\"text\"\n        v-model=\"profileRawArguments\"\n      >\n      <br>\n      profileFormat:\n      <input\n        type=\"text\"\n        v-model=\"profileFormat\"\n      >\n      <br>\n      profileDuration:\n      <input\n        type=\"text\"\n        v-model=\"profileDuration\"\n      >\n      <br>\n\n      <sba-button\n        :disabled=\"profiling\"\n        @click=\"profile(profileSessionName, profileRawArguments, profileDuration, profileFormat)\"\n      >\n        <template v-if=\"!profiling\">\n          <font-awesome-icon icon=\"download\"/>&nbsp;\n          <span>Start profiling</span>\n        </template>\n        <template v-else>\n          <div class=\"loader\">Profiling...</div>\n        </template>\n      </sba-button>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  props: {\n    instance: {\n      type: Object,\n      required: true\n    }\n  },\n  data: () => ({\n    settings: 'd',\n    results: [],\n    profileRawArguments: 'start,event=itimer,interval=1ms',\n    profileSessionName: 'test',\n    profileDuration: '2s',\n    profileFormat: 'FLAMEGRAPH',\n    profiling: false,\n  }),\n  methods: {\n    async profile(sessionName, rawArguments, profileDuration, profileFormat) {\n      this.profiling = true;\n      const durationInMillis = parseToMillis(profileDuration);\n      setTimeout(() => {\n        this.profiling = false;\n        this.updateResultsList()\n      }, durationInMillis)\n\n      await this.instance.axios.post(\n        `actuator/jklee-profile/${sessionName}`,\n        {\n          rawArguments: rawArguments,\n          duration: profileDuration,\n          format: profileFormat,\n        }\n      )\n      .then((response) => {\n        console.log(response)\n      })\n    },\n    async updateResultsList() {\n      const response = await this.instance.axios.get('actuator/jklee-files');\n      this.results = response.data.results;\n    }\n  },\n  async created() {\n    const response = await this.instance.axios.get('actuator/jklee-settings');\n    this.settings = response.data;\n    await this.updateResultsList()\n  }\n};\n\nfunction parseToMillis(timeString) {\n  let value = parseInt(timeString, 10);\n  let unit = timeString.slice(-1);\n  let millis = 0;\n\n  if (unit === 's') {\n    millis = value * 1000;\n  } else if (unit === 'm') {\n    millis = value * 60 * 1000;\n  } else if (unit === 'h') {\n    millis = value * 60 * 60 * 1000;\n  } else if (unit === 'd') {\n    millis = value * 60 * 60 * 24 * 1000;\n  }\n\n  return millis;\n}\n</script>\n\n<style>\n.jklee {\n  font-size: 12pt;\n  width: 80%;\n}\n</style>\n","import jkleeEndpoint from './jklee.vue';\n\nSBA.viewRegistry.addView({\n  name: \"instances/jklee\",\n  parent: \"instances\",\n  path: \"jklee\",\n  component: jkleeEndpoint,\n  label: \"jklee\",\n  isEnabled: ({ instance }) => {\n    return instance.hasEndpoint(\"jklee-settings\");\n  },\n})\n"],"names":["_createElementVNode","_openBlock","_createElementBlock","_toDisplayString","_createVNode","_Fragment","_renderList"],"mappings":"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"}